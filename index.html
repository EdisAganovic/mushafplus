<!DOCTYPE html>
<html lang="bs" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mushaf Plus</title>

    <!-- Tailwind CSS (Static Production Build) -->
    <link rel="stylesheet" href="css/tailwind-output.css?v=0.0.5">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Outfit:wght@300;400;600&display=swap"
        rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css?v=0.0.5">

    <!-- Ionicons -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>

<body class="bg-slate-950 text-slate-50 font-outfit h-screen overflow-hidden flex flex-col">

    <!-- Header -->
    <header class="bg-slate-900 border-b-2 border-emerald-800 shadow-lg z-10 shrink-0 w-full">
        <!-- Desktop/Tablet Header row -->
        <div class="max-w-[1400px] mx-auto flex flex-col md:flex-row w-full items-center">

            <!-- Mimic Main Content Area Structure -->
            <div class="hidden md:flex flex-1 px-3 sm:px-6 py-[0.5rem]  w-full justify-center items-center">
                <div class="w-full max-w-4xl flex items-center justify-between">
                    <!-- Left group: title -->
                    <div class="hidden md:flex items-center gap-[0.5rem] shrink-0">
                        <span class="text-[1.5rem] hidden md:inline">üìñ</span>
                        <h1 id="app-title"
                            class="text-[1.125rem] font-bold bg-gradient-to-r from-emerald-400 to-emerald-600 bg-clip-text text-transparent whitespace-nowrap">
                            Mushaf Plus
                        </h1>
                    </div>

                    <!-- Desktop Search -->
                    <div class="relative group z-50 hidden sm:flex shrink-0 ml-4">
                        <div class="relative w-full max-w-[200px] xl:max-w-[300px]">
                            <input type="text" id="search-input" data-i18n-placeholder="searchPlaceholder"
                                placeholder="Pretra≈æi tekst ili ajet (2:255)..."
                                class="bg-slate-950 border border-slate-700 text-slate-100 h-[2.5rem] pl-[2.25rem] pr-[1rem] rounded-lg outline-none focus:border-emerald-500 transition-all w-full text-[0.875rem] placeholder:text-slate-600 focus:ring-2 focus:ring-emerald-500/20">
                            <ion-icon name="search-outline"
                                class="absolute left-[0.75rem] top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-emerald-500 transition-colors"></ion-icon>
                        </div>
                        <div id="search-results-container"
                            class="absolute top-[3rem] left-0 right-0 w-[400px] max-h-[24rem] bg-slate-900 border border-slate-700 rounded-xl shadow-2xl overflow-y-auto hidden flex-col custom-scrollbar z-50">
                            <div id="search-results-list" class="flex flex-col"></div>
                            <div id="search-empty-state" class="p-[1rem] text-center text-[0.875rem] text-slate-500 hidden"
                                data-i18n="noResults">
                                Nema rezultata
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mimic Sidebar Structure -->
            <div class="flex items-center justify-between md:justify-end px-3 sm:px-6 pt-3 md:mt-0 sm:py-[0.75rem] w-full md:w-80 shrink-0 gap-[0.5rem]">
                <select id="surah-select"
                    class="bg-slate-950 border border-slate-700 text-slate-100 h-[2.5rem] px-[0.5rem] rounded-lg outline-none focus:border-emerald-500 transition-colors cursor-pointer text-[0.875rem] min-w-0 w-0 flex-grow sm:w-auto sm:flex-grow-0 overflow-hidden text-ellipsis">
                    <option value="" disabled selected class="bg-slate-900" data-i18n="selectSurah">Izaberi suru...
                    </option>
                </select>

                <div class="flex items-center gap-[0.5rem] shrink-0">
                    <button id="settings-toggle"
                        class="text-slate-300 hover:text-emerald-500 bg-slate-950 border border-slate-700 hover:bg-slate-800 transition-colors w-[2.5rem] h-[2.5rem] text-[1.25rem] rounded-lg flex items-center justify-center shrink-0">
                        <ion-icon name="options-outline"></ion-icon>
                    </button>
                    <button id="mobile-grid-toggle"
                        class="md:hidden text-slate-100 hover:text-emerald-500 transition-colors w-[2.5rem] h-[2.5rem] text-[1.25rem] rounded-lg hover:bg-slate-800 bg-slate-950 border border-slate-700 flex items-center justify-center shrink-0">
                        <ion-icon name="menu-outline"></ion-icon>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile search row -->
        <div class="relative group z-40 w-full md:hidden flex px-[0.75rem] mt-1 pb-3">
            <div class="relative w-full">
                <input type="text" id="search-input-mobile" data-i18n-placeholder="searchPlaceholder"
                    placeholder="Pretra≈æi tekst ili ajet (2:255)..."
                    class="bg-slate-950 border border-slate-700 text-slate-100 h-[2.5rem] pl-[2.25rem] pr-[1rem] rounded-lg outline-none focus:border-emerald-500 transition-all w-full text-[0.875rem] placeholder:text-slate-600 focus:ring-2 focus:ring-emerald-500/20">
                <ion-icon name="search-outline"
                    class="absolute left-[0.75rem] top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-emerald-500 transition-colors"></ion-icon>
            </div>
            <div id="search-results-container-mobile"
                class="absolute top-[3rem] left-[0.75rem] right-[0.75rem] max-h-[24rem] bg-slate-900 border border-slate-700 rounded-xl shadow-2xl overflow-y-auto hidden flex-col custom-scrollbar z-50">
                <div id="search-results-list-mobile" class="flex flex-col"></div>
                <div id="search-empty-state-mobile" class="p-[1rem] text-center text-[0.875rem] text-slate-500 hidden"
                    data-i18n="noResults">
                    Nema rezultata
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div id="app-container" class="flex-1 flex flex-col md:flex-row overflow-hidden max-w-[1400px] mx-auto w-full">

        <!-- Main Content Area -->
        <main class="flex-1 flex flex-col p-3 sm:p-6 overflow-y-auto items-center min-h-0">

            <!-- Ayah Card -->
            <div
                class="w-full max-w-4xl bg-slate-900 border border-slate-800 rounded-2xl p-4 sm:p-8 shadow-2xl flex flex-col items-center min-h-[250px] sm:min-h-[400px] justify-center relative shrink-0">

                <!-- Navigation Hint -->
                <div class="w-full text-center opacity-40 mb-1">
                    <span data-i18n="quickJump" class="text-[9px] uppercase tracking-[0.2em] text-slate-500 font-bold">
                        Brzi skok: Klikni na broj
                    </span>
                </div>

                <!-- Navigation Badges -->
                <div class="w-full flex justify-center mt-1.5 mb-3 sm:mb-6 gap-1.5 flex-wrap">
                    <!-- Ayah Badge -->
                    <div class="text-[11px] sm:text-sm font-mono text-emerald-500 bg-emerald-500/10 px-3 py-1.5 rounded-full border border-emerald-500/20 flex items-center shadow-md">
                        <label for="ayah-input" data-i18n="ayahLabel" class="cursor-pointer mr-1 opacity-90">Ajet</label>
                        <input type="number" id="ayah-input" min="1" max="286" placeholder="0"
                            class="bg-transparent border-none text-emerald-400 font-bold w-9 text-center outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                        <span class="opacity-90 ml-1">/ <span id="total-ayahs-num">0</span></span>
                    </div>

                    <!-- Juz Badge -->
                    <div class="text-[11px] sm:text-sm font-mono text-amber-500 bg-amber-500/10 px-3 py-1.5 rounded-full border border-amber-500/20 flex items-center gap-1 shadow-md">
                        <label for="juz-input" data-i18n="juzLabel" class="opacity-90 cursor-pointer">D≈æuz</label>
                        <input type="number" id="juz-input" min="1" max="30" placeholder="0"
                            class="bg-transparent border-none text-amber-400 font-bold w-5 text-center outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                    </div>

                    <!-- Page Badge -->
                    <div class="text-[11px] sm:text-sm font-mono text-blue-400 bg-blue-500/10 px-3 py-1.5 rounded-full border border-blue-500/20 flex items-center gap-1 shadow-md">
                        <label for="page-input" data-i18n="pageLabel" class="opacity-90 cursor-pointer">Str.</label>
                        <input type="number" id="page-input" min="1" max="604" placeholder="0"
                            class="bg-transparent border-none text-blue-300 font-bold w-10 text-center outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                    </div>
                </div>

                <div id="arabic-display"
                    class="font-quran quran-text text-[1.5rem] sm:text-4xl md:text-5xl text-right w-full text-slate-100 selection:bg-emerald-800 transition-all duration-300">
                </div>

                <!-- Tajweed Legend -->
                <div id="tajweed-legend-container"
                    class="mt-4 sm:mt-6 mb-3 sm:mb-4 w-full max-w-2xl hidden flex-wrap gap-1.5 justify-center">
                    <div id="tajweed-legend" class="flex flex-wrap gap-1.5 justify-center w-full"></div>
                </div>

                <div id="translation-display"
                    class="text-sm sm:text-lg md:text-xl text-slate-400 text-left max-w-2xl w-full">
                </div>

                <!-- Actions & Navigation -->
                <div class="flex items-center gap-2 sm:gap-3 mt-6 sm:mt-8 w-full max-w-lg">
                    <button id="prev-btn"
                        class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-slate-800 hover:bg-slate-700 transition-all active:scale-95 shrink-0">
                        <ion-icon name="arrow-back-outline" class="text-lg sm:text-xl"></ion-icon>
                    </button>

                    <button id="record-btn"
                        class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-emerald-700 hover:bg-emerald-600 transition-all active:scale-95 shadow-lg shadow-emerald-900/20 relative overflow-hidden shrink-0">
                        <div id="mic-meter-container" class="absolute inset-0 bg-emerald-900/20 hidden">
                            <div id="mic-meter-bar" class="h-full bg-emerald-400/30 transition-all duration-75 w-0">
                            </div>
                        </div>
                        <ion-icon name="mic-outline" class="text-lg sm:text-xl relative z-10"></ion-icon>
                        <span id="record-text" class="hidden" data-i18n="record">Snimi</span>
                    </button>

                    <button id="valid-btn"
                        class="flex-1 flex items-center justify-center gap-1.5 sm:gap-2 py-2 sm:py-3 rounded-xl bg-slate-800 hover:bg-slate-700 transition-all font-semibold active:scale-95 border-2 border-transparent text-xs sm:text-base">
                        <ion-icon name="checkmark-circle-outline" class="text-base sm:text-xl"></ion-icon>
                        <span data-i18n="valid">Taƒçno</span>
                    </button>

                    <button id="bookmark-btn"
                        class="flex-1 flex items-center justify-center gap-1.5 sm:gap-2 py-2 sm:py-3 rounded-xl bg-slate-800 hover:bg-slate-700 transition-all font-semibold active:scale-95 border-2 border-transparent text-xs sm:text-base">
                        <ion-icon name="bookmark-outline" class="text-base sm:text-xl"></ion-icon>
                        <span data-i18n="bookmark">Oznaƒçi</span>
                    </button>

                    <button id="next-btn"
                        class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-slate-800 hover:bg-slate-700 transition-all active:scale-95 shrink-0">
                        <ion-icon name="arrow-forward-outline" class="text-lg sm:text-xl"></ion-icon>
                    </button>
                </div>



                <!-- Navigation Controls -->
                <div id="ayah-audio-container"
                    class="mt-6 sm:mt-8 hidden w-full max-w-lg flex flex-col items-center gap-2">
                    <div
                        class="flex items-center gap-2 sm:gap-4 w-full bg-slate-800/40 p-2 sm:p-3 rounded-2xl border border-slate-700/50 backdrop-blur-sm shadow-inner">
                        <button id="ayah-play-btn"
                            class="w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-emerald-600 text-white hover:bg-emerald-500 transition-all active:scale-90 shadow-lg shadow-emerald-900/40 group overflow-hidden shrink-0">
                            <ion-icon name="play" id="ayah-play-icon" class="text-xl ml-1"></ion-icon>
                            <ion-icon name="pause" id="ayah-pause-icon" class="text-xl hidden"></ion-icon>
                        </button>

                        <div class="flex-1 flex flex-col gap-1 pr-1 sm:pr-2">
                            <div
                                class="flex items-center justify-between text-[9px] sm:text-[10px] text-slate-500 uppercase tracking-widest font-bold">
                                <span id="reciter-name-label" data-i18n="recitation">Recitacija</span>
                                <span id="ayah-audio-time">0:00 / 0:00</span>
                            </div>
                            <div id="ayah-progress-bg"
                                class="h-1.5 sm:h-2 w-full bg-slate-700/50 rounded-full cursor-pointer relative overflow-hidden">
                                <div id="ayah-audio-progress" class="h-full bg-emerald-500 w-0 absolute top-0 left-0">
                                </div>
                            </div>
                        </div>

                        <div class="flex items-center gap-1 sm:gap-2 ml-1 shrink-0">
                            <button id="ayah-speed-btn" data-i18n-title="playbackSpeed"
                                class="text-[9px] sm:text-[10px] font-bold text-slate-300 hover:text-emerald-400 bg-slate-900/80 rounded px-1.5 py-0.5 sm:px-2 sm:py-1 border border-slate-700 transition-colors w-8 sm:w-10 text-center"
                                title="Brzina">1x</button>
                            <button id="ayah-loop-btn" data-i18n-title="loopAyah"
                                class="w-7 h-7 sm:w-8 sm:h-8 flex items-center justify-center text-lg sm:text-xl text-slate-500 hover:text-emerald-400 transition-colors rounded-full hover:bg-slate-800"
                                title="Ponavljaj ajet">
                                <ion-icon name="repeat"></ion-icon>
                            </button>
                        </div>
                    </div>
                    <audio id="ayah-audio" class="hidden"></audio>
                </div>

                <!-- User Recording Player -->
                <div id="user-audio-container" class="mt-2 hidden w-full max-w-lg flex flex-col items-center gap-2">
                    <div
                        class="flex items-center gap-2 sm:gap-4 w-full bg-amber-500/10 p-2 sm:p-3 rounded-2xl border border-amber-500/20 backdrop-blur-sm shadow-inner">
                        <button id="user-play-btn"
                            class="w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-amber-500 text-slate-950 hover:bg-amber-400 transition-all active:scale-90 shadow-lg shadow-amber-900/40 group overflow-hidden shrink-0">
                            <ion-icon name="play" id="user-play-icon" class="text-xl ml-1"></ion-icon>
                            <ion-icon name="pause" id="user-pause-icon" class="text-xl hidden"></ion-icon>
                        </button>

                        <div class="flex-1 flex flex-col gap-1 pr-1 sm:pr-2">
                            <div
                                class="flex items-center justify-between text-[9px] sm:text-[10px] text-amber-500 uppercase tracking-widest font-bold">
                                <span data-i18n="yourRecording">Tvoj snimak</span>
                                <span id="user-audio-time">0:00 / 0:00</span>
                            </div>
                            <div id="user-progress-bg"
                                class="h-1.5 sm:h-2 w-full bg-amber-500/20 rounded-full cursor-pointer relative overflow-hidden">
                                <div id="user-audio-progress" class="h-full bg-amber-500 w-0 absolute top-0 left-0">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Notes Section -->
                <div id="ayah-notes-container"
                    class="mt-4 sm:mt-6 w-full max-w-lg flex flex-col gap-2 opacity-60 hover:opacity-100 transition-opacity">
                    <div
                        class="flex items-center gap-2 text-[10px] text-slate-500 uppercase tracking-widest font-bold ml-1">
                        <ion-icon name="create-outline"></ion-icon>
                        <span data-i18n="notesTitle">Liƒçne bilje≈°ke</span>
                    </div>
                    <textarea id="ayah-notes" data-i18n-placeholder="notesPlaceholder"
                        placeholder="Dodaj podsjetnik (npr. 'Obrati pa≈ænju na ted≈ævid kod rijeƒçi X')..."
                        class="w-full bg-slate-950/50 border border-slate-800 rounded-xl p-3 text-sm text-slate-300 outline-none focus:border-amber-500/50 focus:ring-1 focus:ring-amber-500/20 transition-all resize-none h-16 sm:h-20 placeholder:text-slate-700"></textarea>
                </div>



                <!-- Scroll Spacer -->
                <div class="h-16 w-full shrink-0"></div>


        </main>

        <!-- Sidebar Overlay (Mobile) -->
        <div id="sidebar-overlay"
            class="fixed inset-0 bg-slate-950/80 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300 md:hidden">
        </div>

        <!-- Sidebar -->
        <aside id="sidebar"
            class="fixed inset-y-0 right-0 w-4/5 sm:w-80 bg-slate-900 border-l border-slate-800 p-6 flex flex-col shrink-0 overflow-y-auto z-50 transform translate-x-full transition-transform duration-300 md:relative md:translate-x-0 md:w-80 shadow-2xl md:shadow-none">

            <div class="flex justify-between items-center mb-6 md:hidden">
                <h2 class="text-lg font-bold text-slate-200" data-i18n="menu">Meni</h2>
                <button id="sidebar-close" class="text-3xl text-slate-400 hover:text-slate-200 transition-colors">
                    <ion-icon name="close-outline"></ion-icon>
                </button>
            </div>

            <!-- Hifz Mode Toggle -->
            <div class="mb-4 bg-rose-500/5 border border-rose-500/20 rounded-xl p-3">
                <div class="flex items-center justify-between gap-2">
                    <div class="flex flex-col flex-1">
                        <span class="text-xs font-bold text-rose-400 uppercase tracking-wider">Hifz Mod</span>
                        <span id="hifz-range-text" class="text-[10px] text-slate-500 line-clamp-1">Klikni na ajet za opseg</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer shrink-0">
                        <input type="checkbox" id="hifz-toggle" class="sr-only peer">
                        <div
                            class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-rose-500">
                        </div>
                    </label>
                </div>
            </div>

            <!-- Progress Section -->
            <div class="mb-8">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-semibold text-slate-400" data-i18n="surahProgress">Progres</span>
                    <span id="progress-percent" class="text-sm font-bold text-emerald-400">0 / 0</span>
                </div>
                <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                    <div id="progress-bar-fill"
                        class="bg-gradient-to-r from-emerald-600 to-emerald-400 h-full w-0 transition-all duration-700 ease-out">
                    </div>
                </div>
            </div>

            <h3 id="ayah-grid-title" class="text-slate-200 font-bold mb-2 flex items-center gap-2 text-sm">
                <ion-icon name="grid-outline"></ion-icon>
                <span data-i18n="ayahGrid">Ajeti</span>
            </h3>

            <!-- Grid Legend -->
            <div class="flex flex-wrap gap-3 mb-3 text-[10px] font-medium text-slate-400 px-1">
                <div class="flex items-center gap-1">
                    <div class="w-2.5 h-2.5 bg-emerald-500 rounded-sm"></div>
                    Trenutni ajet
                </div>
                <div class="flex items-center gap-1">
                    <div class="w-2 h-2 bg-rose-400 rounded-full"></div>
                    Hifz mod
                </div>
                <div class="flex items-center gap-1">
                    <div class="w-2 h-2 bg-amber-500 rounded-full"></div>
                    Poƒçetak d≈æuza
                </div>
                <div class="flex items-center gap-1">
                    <div class="w-2 h-2 bg-blue-400 rounded-full"></div>
                    Nova stranica
                </div>
            </div>

            <!-- Scrollable Ayah Grid -->
            <div class="flex-[3] overflow-y-auto custom-scrollbar mb-2 min-h-[120px] bg-slate-950/50 p-3 rounded-xl border border-slate-800/60">
                <div id="ayah-grid" class="grid grid-cols-5 content-start gap-2">
                    <!-- Ayah cells will be injected here -->
                </div>
            </div>

            <!-- Bookmarks Section -->
            <h3 class="text-slate-200 font-bold mb-4 flex items-center gap-2 border-t border-slate-800 pt-4">
                <ion-icon name="bookmarks-outline"></ion-icon>
                <span data-i18n="bookmarks">Oznaƒçeno</span>
            </h3>
            <div id="bookmarks-list"
                class="flex-[2] overflow-y-auto flex flex-col gap-2 pr-2 custom-scrollbar text-sm min-h-[150px]">
                <!-- Bookmarks will be injected here -->
                <div class="text-slate-500 italic text-center w-full mt-2 text-xs" data-i18n="noBookmarks">Jo≈° nema
                    oznaka</div>
            </div>

            <!-- Shortcuts Section -->
            <div class="mt-auto border-t border-slate-800 pt-4 hidden md:block">
                <h3 class="text-slate-200 font-bold mb-3 flex items-center gap-2 text-sm">
                    <ion-icon name="keypad-outline"></ion-icon>
                    <span data-i18n="keyboardShortcuts">Preƒçice na tastaturi</span>
                </h3>
                <div class="flex flex-col gap-2 text-[10px] text-slate-400 font-medium px-1 uppercase tracking-wider">
                    <div class="flex justify-between items-center">
                        <span data-i18n="navAyahs">Navigacija</span>
                        <div class="flex gap-1">
                            <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">‚Üê</kbd>
                            <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">‚Üí</kbd>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span data-i18n="recordStop">Snimi / Stop</span>
                        <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">Space</kbd>
                    </div>
                    <div class="flex justify-between items-center">
                        <span data-i18n="markValid">Oznaƒçi taƒçno</span>
                        <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">V</kbd>
                    </div>
                    <div class="flex justify-between items-center">
                        <span data-i18n="playRecitation">Pusti recitaciju</span>
                        <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">P /
                            Enter</kbd>
                    </div>
                    <div class="flex justify-between items-center">
                        <span data-i18n="playRecording">Pusti snimak</span>
                        <kbd class="bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700 shadow-sm">U</kbd>
                    </div>
                </div>
            </div>

        </aside>
    </div>

    <!-- Settings Overlay -->
    <div id="settings-overlay"
        class="fixed inset-0 bg-slate-950/80 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300">
    </div>

    <!-- Settings Drawer -->
    <aside id="settings-drawer"
        class="fixed inset-y-0 right-0 w-4/5 sm:w-80 bg-slate-900 border-l border-slate-800 p-6 flex flex-col shrink-0 overflow-y-auto z-50 transform translate-x-full transition-transform duration-300 shadow-2xl">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-lg font-bold text-slate-200 flex items-center gap-2">
                <ion-icon name="options-outline"></ion-icon>
                <span data-i18n="preferences">Postavke</span>
            </h2>
            <button id="settings-close" class="text-3xl text-slate-400 hover:text-slate-200 transition-colors">
                <ion-icon name="close-outline"></ion-icon>
            </button>
        </div>

        <!-- Settings Section -->
        <div class="mb-6">
            <div class="space-y-4">
                <div>
                    <div class="flex justify-between mb-1 translate-y-1">
                        <label class="text-[10px] text-slate-400 uppercase tracking-wider"
                            data-i18n="arabicFontSize">Veliƒçina arapskog fonta</label>
                        <span id="ar-size-val" class="text-xs font-bold text-emerald-400">140%</span>
                    </div>
                    <input type="range" id="ar-size-slider" min="80" max="600" step="10" value="140"
                        class="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500">
                </div>

                <div>
                    <div class="flex justify-between mb-1 translate-y-1">
                        <label class="text-[10px] text-slate-400 uppercase tracking-wider"
                            data-i18n="translationFontSize">Veliƒçina prijevoda</label>
                        <span id="bs-size-val" class="text-xs font-bold text-emerald-400">100%</span>
                    </div>
                    <input type="range" id="bs-size-slider" min="80" max="250" step="10" value="100"
                        class="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500">
                </div>

                <div>
                    <div class="flex justify-between mb-1 translate-y-1">
                        <label class="text-[10px] text-slate-400 uppercase tracking-wider"
                            data-i18n="arabicLineHeight">Razmak redova (arapski)</label>
                        <span id="ar-lh-val" class="text-xs font-bold text-emerald-400">1.6</span>
                    </div>
                    <input type="range" id="ar-lh-slider" min="1.0" max="4.0" step="0.1" value="1.6"
                        class="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500">
                </div>

                <!-- Live Preview: Arabic -->
                <div class="mt-2 p-3 bg-slate-950/50 rounded-xl border border-slate-800">
                    <div class="text-[10px] text-slate-500 uppercase tracking-wider mb-2 font-bold">Prikaz ‚Äî Arapski
                    </div>
                    <div id="settings-preview-ar" class="font-quran text-slate-100 text-right" dir="rtl"
                        style="font-size:1.4rem; line-height:1.6">ŸÇŸèŸÑŸí ŸáŸèŸàŸé Ÿ±ŸÑŸÑŸéŸëŸáŸè ÿ£Ÿéÿ≠ŸéÿØŸå Ÿ° Ÿ±ŸÑŸÑŸéŸëŸáŸè Ÿ±ŸÑÿµŸéŸëŸÖŸéÿØŸè Ÿ¢</div>
                </div>

                <!-- Live Preview: Translation -->
                <div class="mt-2 p-3 bg-slate-950/50 rounded-xl border border-slate-800">
                    <div class="text-[10px] text-slate-500 uppercase tracking-wider mb-2 font-bold">Prikaz ‚Äî Prijevod
                    </div>
                    <div id="settings-preview-bs" class="font-outfit text-slate-400 text-center" style="font-size:1rem">
                        Reci: "On je Allah - Jedan! Allah je Utoƒçi≈°te svakom."</div>
                </div>

                <div class="pt-2">
                    <label class="text-[10px] text-slate-400 uppercase tracking-wider block mb-1">Uƒçaƒç (Reciter)</label>
                    <select id="reciter-select"
                        class="w-full bg-slate-950/50 text-slate-300 rounded-xl p-2.5 text-sm border border-slate-800 outline-none focus:border-emerald-500 transition-colors cursor-pointer appearance-none">
                        <option value="local" class="bg-slate-900">Lokalni fajlovi</option>
                        <option value="Alafasy_128kbps" class="bg-slate-900">Mishary Rashid Alafasy</option>
                        <option value="Abdurrahmaan_As-Sudais_192kbps" class="bg-slate-900">Abdurrahmaan As-Sudais</option>
                        <option value="Husary_128kbps" class="bg-slate-900">Mahmoud Khalil Al-Husary</option>
                        <option value="MaherAlMuaiqly128kbps" class="bg-slate-900">Maher Al-Muaiqly</option>
                        <option value="Saood_ash-Shuraym_128kbps" class="bg-slate-900">Sa'ud ash-Shuraym</option>
                    </select>
                </div>

                <div class="pt-2">
                    <label class="text-[10px] text-slate-400 uppercase tracking-wider block mb-1"
                        data-i18n="appTheme">Tema aplikacije</label>
                    <select id="theme-select"
                        class="w-full bg-slate-950/50 text-slate-300 rounded-xl p-2.5 text-sm border border-slate-800 outline-none focus:border-emerald-500 transition-colors cursor-pointer appearance-none">
                        <option value="" class="bg-slate-900" data-i18n="themeEmerald">Smaragdna (Podrazumijevano)
                        </option>
                        <option value="blue" class="bg-slate-900" data-i18n="themeBlue">Kraljevski plava</option>
                        <option value="amber" class="bg-slate-900" data-i18n="themeAmber">Zlato</option>
                        <option value="rose" class="bg-slate-900" data-i18n="themeRose">Ru≈æa</option>
                        <option value="purple" class="bg-slate-900" data-i18n="themePurple">Ljubiƒçasta</option>
                        <option value="teal" class="bg-slate-900" data-i18n="themeTeal">Tirkizna</option>
                    </select>
                </div>

                <div
                    class="pt-2 flex items-center justify-between bg-slate-950/30 p-3 rounded-xl border border-slate-800 mt-2">
                    <div class="flex flex-col">
                        <span class="text-sm font-bold text-slate-300" data-i18n="lightMode">Svijetli mod</span>
                        <span class="text-[10px] text-slate-500" data-i18n="lightModeDesc">ƒåistiji prikaz za
                            ƒçitanje</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="lightmode-toggle" class="sr-only peer">
                        <div
                            class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500">
                        </div>
                    </label>
                </div>

                <div
                    class="pt-2 flex items-center justify-between bg-slate-950/30 p-3 rounded-xl border border-slate-800 mt-2">
                    <div class="flex flex-col">
                        <span class="text-sm font-bold text-slate-300" data-i18n="autoPlayNext">Automatski
                            sljedeƒái</span>
                        <span class="text-[10px] text-slate-500" data-i18n="autoPlayDesc">Nastavi kad audio
                            zavr≈°i</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="autoplay-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500">
                        </div>
                    </label>
                </div>

                <div
                    class="pt-2 flex items-center justify-between bg-slate-950/30 p-3 rounded-xl border border-slate-800 mt-2">
                    <div class="flex flex-col">
                        <span class="text-sm font-bold text-slate-300" data-i18n="tajweedFormatting">Ted≈ævidska
                            pravila</span>
                        <span class="text-[10px] text-slate-500" data-i18n="tajweedDesc">Pravila uƒçenja u bojama</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="tajweed-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500">
                        </div>
                    </label>
                </div>

                <div
                    class="pt-2 flex items-center justify-between bg-slate-950/30 p-3 rounded-xl border border-slate-800 mt-2">
                    <div class="flex flex-col">
                        <span class="text-sm font-bold text-slate-300" data-i18n="tajweedLegend">Nazivi ted≈ævidskih pravila</span>
                        <span class="text-[10px] text-slate-500" data-i18n="tajweedLegendDesc">Prika≈æi legendu ispod ajeta</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="tajweed-legend-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500">
                        </div>
                    </label>
                </div>
            </div>
        </div>

        <!-- Data Transfer Section -->
        <div class="border-t border-slate-800 pt-6 mt-auto">
            <h3 class="text-slate-200 font-bold mb-4 flex items-center gap-2">
                <ion-icon name="cloud-download-outline"></ion-icon>
                <span data-i18n="dataTransfer">Backup</span>
            </h3>
            <div class="flex gap-2">
                <button id="export-btn"
                    class="flex-1 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-200 text-sm font-semibold py-2 rounded-lg transition-colors border border-slate-700">
                    <ion-icon name="download-outline"></ion-icon>
                    <span data-i18n="export">Izvezi</span>
                </button>
                <button id="import-btn"
                    class="flex-1 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-200 text-sm font-semibold py-2 rounded-lg transition-colors border border-slate-700">
                    <ion-icon name="cloud-upload-outline"></ion-icon>
                    <span data-i18n="import">Uvezi</span>
                </button>
                <input type="file" id="import-file" class="hidden" accept=".json">
            </div>
        </div>
        </div>
    </aside>

    <!-- Hidden audio element for playback -->
    <audio id="audio-playback" class="hidden"></audio>

    <!-- Swipe UX: First-time Toast -->
    <div id="swipe-toast" class="swipe-toast">
        <div class="toast-direction">
            <ion-icon name="arrow-back-outline"></ion-icon>
            <span>Prethodni ajet</span>
        </div>
        <div class="toast-divider"></div>
        <div class="toast-direction">
            <span>Slijedeƒái ajet</span>
            <ion-icon name="arrow-forward-outline"></ion-icon>
        </div>
    </div>

    <!-- Core Data -->
    <script src="data/quran_data.js?v=0.0.5"></script>
    <script src="js/tajweed.js?v=0.0.5"></script>
    <script src="js/i18n.js?v=0.0.5"></script>

    <!-- App Modular Logic -->
    <script src="js/config.js?v=0.0.5"></script>
    <script src="js/utils.js?v=0.0.5"></script>
    <script src="js/effects.js?v=0.0.5"></script>
    <script src="js/audio.js?v=0.0.5"></script>
    <script src="js/render.js?v=0.0.5"></script>
    <script src="js/actions.js?v=0.0.5"></script>
    <script src="js/quranMeta.js?v=0.0.5"></script>

    <!-- Entry Point -->
    <script src="js/app.js?v=0.0.5"></script>
</body>

</html>